% author: Daniele Tomatis
% company: newcleo, Turin, Italy
% date: sept 6th, 2022
% object: outer nwcler template

\mode<presentation>

% frame title
\defbeamertemplate*{frametitle}{nwcler}[1][]{
  \vskip.03\paperheight
  \begin{beamercolorbox}[wd=\paperwidth]{frametitle}
    \begin{tikzpicture}
      \vspace*{0.75em} \hspace*{1em}
      \ifx\insertframesubtitle\@empty%
        {\node[anchor=west] at (3.2,0.61){
            \usebeamerfont{frametitle}%
            % \ifx\insertsubsectionnumber\@empty%
            % \insertsectionnumber.
            % \else%
            % \insertsectionnumber{.}\insertsubsectionnumber
            % \fi
            \insertframetitle
          };}
        \else%
        {\node[anchor=west] at (3.2,0.81){
            \usebeamerfont{frametitle}\insertframetitle
          };
          \node[anchor=west] at (3.2,0.31){
            \usebeamerfont{framesubtitle}\insertframesubtitle
          };}
      \fi
    \end{tikzpicture}
  \end{beamercolorbox}
}

% footer / footline
\setbeamertemplate{footline}{
  % in case you do not want to consider some starting slide or frame
  % \ifnum \theframenumber=1
  % % This is the ToC, do nothing
  % \else
  \begin{minipage}{\paperwidth}
    \hfil
    \includegraphics[width=0.95\paperwidth,height=2.25pt]{
      images/footrule_gray.pdf}
    \hfil
  \end{minipage}
  \leavevmode\hbox{%
    \begin{beamercolorbox}[wd=.275\paperwidth,ht=3ex,dp=1.5ex,left]]{
      %title in head/foot}{
      \hspace*{0.25em}
      \raisebox{-.25\height}{\includegraphics[width=\logowd]{\bkglogo}}
      \IfFileExists{\secondlogo}{
        \raisebox{-.25\height}{\includegraphics[width=\secondlogowd]{\secondlogo}}
      }{
        \@latex@warning{Missing second logo or wrong path}
      }
      \hspace*{0.25em}
      }
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.45\paperwidth,ht=3ex,dp=1.5ex,center]
      {author in head/foot}%
      \usebeamerfont{author in head/foot}
      \insertshortauthor{} -- \insertshortdate{}
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.275\paperwidth,ht=3ex,dp=1.5ex,right]
      {date in head/foot}%
      \usebeamerfont{author in head/foot}\hspace*{2em}
      \insertframenumber{} / \insertmainframenumber\hspace*{2ex}
    \end{beamercolorbox}
  }
  % \fi
}

\defbeamertemplate{footline}{section page footline}{%
  \begin{minipage}{\paperwidth}
    \hfil
    \textcolor{white}{\rule{0.94\textwidth}{2pt}}
    \hfil  % \newline 
  \end{minipage}
  \mbox{
    \begin{beamercolorbox}[wd=0.73\paperwidth,ht=2.5ex,dp=1.5ex]{}
      {\hspace*{0.25em}
        \raisebox{-.25\height}{\includegraphics[width=\logowd]{
            \thelogo
          }}
        \IfFileExists{\secondlogo}{
          \hfill
          \raisebox{-.25\height}{\includegraphics[width=\secondlogowd]{\secondlogo}}
        }{ \@latex@warning{Missing second logo or wrong path} }
        \hspace*{0.25em}
      }
    \end{beamercolorbox}
    \begin{beamercolorbox}[wd=.27\paperwidth,ht=2.5ex,dp=1.5ex,right]{pages in section foot}%
      {\tiny
      \hspace*{3ex}\insertframenumber{} / \insertmainframenumber\hspace*{3ex}
      }
    \end{beamercolorbox}
  }
}

\def\ps@navigation@sectionpage{%
  \setbeamertemplate{footline}[section page footline]
  \@nameuse{ps@navigation}
}
% the following is commented because the 'add' is performed only once
% \addtobeamertemplate{section page}{\thispagestyle{navigation@sectionpage}}{}

% \pretocmd{\tableofcontents}{\thispagestyle{navigation@titlepage}}{}{}

\mode<all>